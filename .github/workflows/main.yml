name: Debian Sysroot Image

on: push

jobs:
  build:
    runs-on: ubuntu-latest
    continue-on-error: true

    strategy:
      matrix:
        arch: ['ARM64', 'ARM', 'Amd64', 'I386']

    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Install Deps
      run: sudo apt install -y binutils-arm-linux-gnueabi binutils-arm-linux-gnueabihf binutils-mips64el-linux-gnuabi64 binutils-mipsel-linux-gnu

    - name: Build
      run: ./build/linux/sysroot_scripts/sysroot-creator-sid.sh BuildSysroot${{ matrix.arch }}

    - name: Release
      uses: softprops/action-gh-release@v0.1.14
      if: startsWith(github.ref, 'refs/tags/')
      with:
        draft: true
        files: out/sysroot-build/sid/*_sysroot.tar.xz
